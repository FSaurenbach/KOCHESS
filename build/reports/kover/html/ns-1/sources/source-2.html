


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>korge-hello-world Coverage Report > GameScene</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope: korge-hello-world<span class="separator">|</span>    <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">&lt;empty package name&gt;</a>
</div>

<h1>Coverage Summary for Class: GameScene (&lt;empty package name&gt;)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">GameScene</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/51)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/390)
  </span>
</td>
</tr>
  <tr>
    <td class="name">GameScene$sceneMain$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">GameScene$sceneMain$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/20)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/255)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/78)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/651)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;import korlibs.image.bitmap.*
&nbsp;import korlibs.image.color.*
&nbsp;import korlibs.image.format.*
&nbsp;import korlibs.io.file.std.*
&nbsp;import korlibs.korge.*
&nbsp;import korlibs.korge.input.*
&nbsp;import korlibs.korge.scene.*
&nbsp;import korlibs.korge.view.*
&nbsp;import korlibs.korge.view.filter.*
&nbsp;import korlibs.math.*
&nbsp;import korlibs.math.geom.*
&nbsp;
&nbsp;val board = Array(8) { Array(8) { SolidRect(512 / 8, 512 / 8) } }
&nbsp;
&nbsp;var cells = ArrayList&lt;Cell&gt;()
&nbsp;var whitePawn: Bitmap? = null
&nbsp;var blackPawn: Bitmap? = null
&nbsp;var whiteRook: Bitmap? = null
&nbsp;var blackRook: Bitmap? = null
&nbsp;var lastClicked: Point? = null
&nbsp;var pieces = ArrayList&lt;Piece&gt;()
&nbsp;var whiteTurn = true
&nbsp;var markedCells = ArrayList&lt;Cell&gt;()
&nbsp;suspend fun main() = Korge(windowSize = Size(512, 512), backgroundColor = Colors[&quot;#2b2b2b&quot;]) {
&nbsp;    val sceneContainer = sceneContainer()
&nbsp;
&nbsp;    whitePawn = resourcesVfs[&quot;w_pawn.png&quot;].readBitmap()
&nbsp;    blackPawn = resourcesVfs[&quot;b_pawn.png&quot;].readBitmap()
&nbsp;    whiteRook = resourcesVfs[&quot;w_rook.png&quot;].readBitmap()
&nbsp;    blackRook = resourcesVfs[&quot;b_rook.png&quot;].readBitmap()
&nbsp;    sceneContainer.changeTo { GameScene(sceneContainer) }
&nbsp;}
&nbsp;
&nbsp;
<b class="nc">&nbsp;class GameScene(private val cont: SceneContainer) : PixelatedScene(512, 512) {</b>
&nbsp;
&nbsp;
&nbsp;    override suspend fun SContainer.sceneMain() {
&nbsp;
<b class="nc">&nbsp;        var d = 0</b>
<b class="nc">&nbsp;        for (cx in 0 until 8) {</b>
<b class="nc">&nbsp;            for (cy in 0 until 8) {</b>
&nbsp;
<b class="nc">&nbsp;                if (d.isEven) {</b>
<b class="nc">&nbsp;                    val cl = Cell(Colors.WHITE, cx, cy, cont)</b>
<b class="nc">&nbsp;                    cells.add(cl)</b>
&nbsp;
&nbsp;
&nbsp;                } else {
<b class="nc">&nbsp;                    val cl = Cell(Colors.BLACK, cx, cy, cont)</b>
<b class="nc">&nbsp;                    cells.add(cl)</b>
&nbsp;
&nbsp;                }
<b class="nc">&nbsp;                d++</b>
&nbsp;            }
<b class="nc">&nbsp;            d++</b>
&nbsp;        }
<b class="nc">&nbsp;        val pw1 = Piece(PieceKind.WhitePawn, Colors.WHITE, 0, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb1 = Piece(PieceKind.BlackPawn, Colors.BLACK, 0, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw2 = Piece(PieceKind.WhitePawn, Colors.WHITE, 1, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb2 = Piece(PieceKind.BlackPawn, Colors.BLACK, 1, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw3 = Piece(PieceKind.WhitePawn, Colors.WHITE, 2, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb3 = Piece(PieceKind.BlackPawn, Colors.BLACK, 2, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw4 = Piece(PieceKind.WhitePawn, Colors.WHITE, 3, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb4 = Piece(PieceKind.BlackPawn, Colors.BLACK, 3, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw5 = Piece(PieceKind.WhitePawn, Colors.WHITE, 4, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb5 = Piece(PieceKind.BlackPawn, Colors.BLACK, 4, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw6 = Piece(PieceKind.WhitePawn, Colors.WHITE, 5, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb6 = Piece(PieceKind.BlackPawn, Colors.BLACK, 5, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw7 = Piece(PieceKind.WhitePawn, Colors.WHITE, 6, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb7 = Piece(PieceKind.BlackPawn, Colors.BLACK, 6, 6, cont = cont)</b>
<b class="nc">&nbsp;        val pw8 = Piece(PieceKind.WhitePawn, Colors.WHITE, 7, 1, cont = cont)</b>
<b class="nc">&nbsp;        val pb8 = Piece(PieceKind.BlackPawn, Colors.BLACK, 7, 6, cont = cont)</b>
&nbsp;        // Rooks
<b class="nc">&nbsp;        val rw1 = Piece(PieceKind.WhiteRook, Colors.WHITE, 5, 5, cont = cont)</b>
<b class="nc">&nbsp;        val rb1 = Piece(PieceKind.BlackRook, Colors.BLACK, 3, 3, cont = cont)</b>
<b class="nc">&nbsp;        pieces.add(pw1)</b>
<b class="nc">&nbsp;        pieces.add(pb1)</b>
<b class="nc">&nbsp;        pieces.add(pw2)</b>
<b class="nc">&nbsp;        pieces.add(pb2)</b>
<b class="nc">&nbsp;        pieces.add(pw3)</b>
<b class="nc">&nbsp;        pieces.add(pb3)</b>
<b class="nc">&nbsp;        pieces.add(pw4)</b>
<b class="nc">&nbsp;        pieces.add(pb4)</b>
<b class="nc">&nbsp;        pieces.add(pw5)</b>
<b class="nc">&nbsp;        pieces.add(pb5)</b>
<b class="nc">&nbsp;        pieces.add(pw6)</b>
<b class="nc">&nbsp;        pieces.add(pb6)</b>
<b class="nc">&nbsp;        pieces.add(pw7)</b>
<b class="nc">&nbsp;        pieces.add(pb7)</b>
<b class="nc">&nbsp;        pieces.add(pw8)</b>
<b class="nc">&nbsp;        pieces.add(pb8)</b>
<b class="nc">&nbsp;        pieces.add(rw1)</b>
<b class="nc">&nbsp;        pieces.add(rb1)</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        var newPosition: Pair&lt;Int, Int&gt;? = null</b>
<b class="nc">&nbsp;        var currentPos: Pair&lt;Int, Int&gt;? = null</b>
<b class="nc">&nbsp;        var piss: Piece? = null</b>
<b class="nc">&nbsp;        draggableCloseable(onMouseDrag {</b>
<b class="nc">&nbsp;            newPosition = decodePosition(this.globalMousePos)</b>
&nbsp;
&nbsp;        }) { info: DraggableInfo -&gt;
<b class="nc">&nbsp;            if (info.start) {</b>
<b class="nc">&nbsp;                for (piece in pieces) {</b>
&nbsp;
<b class="nc">&nbsp;                    if (piece.position == board[newPosition!!.second][newPosition!!.first].pos) {</b>
<b class="nc">&nbsp;                        println(&quot;${piece.pieceKind}&quot;)</b>
<b class="nc">&nbsp;                        currentPos = newPosition</b>
<b class="nc">&nbsp;                        piss = piece</b>
<b class="nc">&nbsp;                        for (cell in cells) {</b>
<b class="nc">&nbsp;                            var clx = cell.cx</b>
<b class="nc">&nbsp;                            var cly = cell.cy</b>
<b class="nc">&nbsp;                            var clxy = Pair(clx, cly)</b>
<b class="nc">&nbsp;                            if (newPosition!! == Pair(clx, cly)) {</b>
<b class="nc">&nbsp;                                println(&quot;Found Cell where piece is located: $clx, $cly&quot;)</b>
&nbsp;                            }
&nbsp;                            // Check where the piece can move to by using the move checker function and print out the location of the cells
<b class="nc">&nbsp;                            if (piss!!.moveChecker(newPosition!!, clxy, false)) {</b>
<b class="nc">&nbsp;                                println(&quot;Can move to: $clx, $cly&quot;)</b>
<b class="nc">&nbsp;                                changeColor(cly, clx, false)</b>
<b class="nc">&nbsp;                                markedCells.add(cell)</b>
&nbsp;                            }
&nbsp;
&nbsp;
&nbsp;                        }
&nbsp;
&nbsp;
&nbsp;                    }
&nbsp;                }
&nbsp;                // Go through every cell in cells and check with the move checker function on which cell the piece could move and print it out
&nbsp;
&nbsp;
&nbsp;            }
<b class="nc">&nbsp;            if (info.end &amp;&amp; piss != null) {</b>
<b class="nc">&nbsp;                println(&quot;pieceKind: ${piss!!.pieceKind} location: ${decodePosition(piss!!.position)}&quot;)</b>
<b class="nc">&nbsp;                println(&quot;End \n \n \n \n \n&quot;)</b>
<b class="nc">&nbsp;                if (piss!!.moveChecker(currentPos!!, newPosition!!, true)) piss!!.moveTo(</b>
<b class="nc">&nbsp;                    newPosition!!.first, newPosition!!.second</b>
&nbsp;                )
<b class="nc">&nbsp;                else piss!!.moveTo(currentPos!!.first, currentPos!!.second)</b>
<b class="nc">&nbsp;                for (cell in markedCells) {</b>
<b class="nc">&nbsp;                    changeColor(cell.cy, cell.cx, true)</b>
&nbsp;                }
<b class="nc">&nbsp;                markedCells.clear()</b>
&nbsp;
<b class="nc">&nbsp;                piss = null</b>
&nbsp;
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;}
&nbsp;
&nbsp;fun changeColor(cly: Int, clx: Int, back: Boolean) {
&nbsp;    if (back) {
&nbsp;        for (cell in cells) {
&nbsp;            if (cell.cx == clx &amp;&amp; cell.cy == cly) {
&nbsp;                board[cly][clx].filter = null
&nbsp;            }
&nbsp;        }
&nbsp;    } else {
&nbsp;        board[cly][clx].filter = BlurFilter(20.0)
&nbsp;    }
&nbsp;
&nbsp;}
&nbsp;
&nbsp;// Check if a piece is in the way of a rook
&nbsp;
&nbsp;
&nbsp;
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-03-02 10:19</div>
</div>
</body>
</html>
